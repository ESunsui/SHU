# 线性规划及单纯形法

## 线性规划问题的数学模型

### 规划问题

​		生产和经营管理中经常提出如何合理安排，使人力、物力等各种资源得到充分利用，获得最大的效益。

​		线性规划通常解决下列两类问题：

1. 当任务或目标确定后，如何统筹兼顾，合理安排，用最少的资源（如资金、设备、原标材料、人工、时间等）去完成确定的任务或目标
2. 在一定的资源条件限制下，如何组织安排生产获得最好的经济效益（如产品量最多 、利润最大）

### 线性规划的数学模型的构成

​		线性规划的数学模型由三个要素构成：

- 决策变量 Decision variables
- 目标函数 Objective function
- 约束条件 Constraints

​		辨别一个模型是线性规划模型：

- 问题的目标函数是多个决策变量的线性函数，通常是求最大值或最小值
- 问题的约束条件是一组多个决策变量的线性不等式或等式。 

### 线性规划数学模型的一般形式

#### 基本形式

​		目标函数：
$$
max(z)=\sum^n_{j=1}c_jx_j\quad\quad min(z)=\sum^n_{j=1}c_jx_j
$$
​		约束条件：
$$
\sum^n_{j=1}a_{ij}x_j \leq b_i \quad (i=1,2,\dots,m)
$$

$$
x_j \geq 0 \quad (j=1,2,\dots,n)
$$

#### 向量形式

​		目标函数：
$$
max(z)=c^Tx\quad\quad min(z)=c^Tx
$$
​		约束条件：
$$
\begin{cases} \sum p_jx_j \leq b \\ x \geq 0 \end{cases}
\quad \quad
\begin{cases} \sum p_jx_j = b \\ x \geq 0 \end{cases}
\quad \quad
\begin{cases} \sum p_jx_j \geq b \\ x \geq 0 \end{cases}
$$
​		其中：
$$
c=(c_1,c_2,\dots,c_n)^T\quad 
x=\begin{bmatrix} x_1 \\x_2 \\ \vdots \\ x_n \end{bmatrix}\quad
p_j=\begin{bmatrix} a_{1j} \\ a_{2j} \\ \vdots \\a_{mj} \end{bmatrix} \quad
b=\begin{bmatrix} b_1 \\ b_2 \\ \vdots \\ b_m \end{bmatrix}
$$

#### 标准形式

$$
max(Z)=\sum^n_{j=1}c_jx_j
$$

$$
s.t\begin{cases} \sum^n_{j=1}a_{ij}x_j=b_i\quad i=1,2,\dots,m \\ x_j \geq 0 \quad j=1,2,\dots,n \end{cases}
$$

​		特点：

1. 目标函数求最大值
2. 约束条件均为等式方程，且右端常数项$b_i$都大于等于0
3. 决策变量$x_j$非负

### 线性规划问题标准形式转换

#### 目标函数转换

​		如果是求极小值$min(Z)=\sum^n_{j=1}c_jx_j$，可以将目标函数乘以-1，转化为求极大值问题，即
$$
令z'=-z,\quad max(Z')=-min(Z)=-\sum^n_{j=1}c_jx_j
$$

#### 变量的变换

​		若存在无约束的变量$x_j$，可令$x_j=x_j'-x_j''$，其中$x_j'\geq0,x_j''\geq0$.

​		若存在变量$x_i\leq0$，令$x_i'=-x_j$，可得$x_j'\geq0$

#### 约束方程的转换

​		由不等式转换为等式。
$$
\sum a_{ij}x_j \leq b_i \rightarrow \sum a_{ij}x_j+x_{n+1}=b_i\quad x_{n+1} \geq 0
$$

$$
\sum a_{ij}x_j \geq b_i \rightarrow \sum a_{ij}x_j-x_{n+1}=b_i\quad x_{n+1} \geq 0
$$

#### 决策变量有上下界的转换

$$
1 \leq x_3 \leq 4 \quad \rightarrow \quad x_3'=x_3-1\geq0,x_3'\leq3
$$

#### 含有绝对值

$$
令x_1=\frac{x+|x|}{2},x_2=\frac{x-|x|}{2},\quad x=x_1-x_2, |x|=x_1+x_2
$$

###  线性规划问题的解

​		满足约束条件的解为可行解。所有可行解 的集合为可行域。

​		使目标函数达到最大值的可行解称为最优解。

1. 图解法
2. 单纯形法

$$
线性规划问题 \begin{cases} 图解法 \begin{cases} 双变量-直角坐标 \\ 三变量-立体坐标 \end{cases} \\ 单纯形法-必须化为标准形式 \end{cases}
$$

## 图解法

#### 两变量线性规划问题的图解法

1. 线性不等式的几何意义— 半平面
2. 图解法步骤
   1. 作出LP问题的可行域
   2. 作出目标函数的等值线
   3. 移动等值线到可行域边界得到最优点

**若LP问题存在最优解，则必在可行域的某个极点上找到**。

​		一般的，当等值线沿目标函数法向量(梯度)方向平行移动时，目标函数值逐步增加；当等值线沿目标函数法向量反方向平行移动时，目标函数值逐步减少。

#### 图解法的特殊情况

1. LP存在多个最优解：以z为参数的直线族与可行域某一条边平行， 最终重合，则 该LP存在多个解。
2. LP问题无可行解：若LP的可行域为空集，则该LP问题无可行解。
3. LP问题存在无界解：若LP的可行域无界，则该LP可能存在无界解。

#### 图解法的作用与要点

​		能解决少量问题，揭示了线性规划问题的若干规律。
$$
LP问题 \begin{cases} 有可行解 \begin{cases} 有最优解 \begin{cases} 唯一解 \\ 无穷多解 \end{cases} \\ 无最优解(可行域无界) \end{cases} \\ 无可行解(无解) \end{cases}
$$
​		作图的关键有三点：

1. 可行解区域要画正确
2. 目标函数增加的方向不能画错
3. 目标函数的直线怎样平行移动

## LP问题的基本性质

### 可行域的凸性

​		可行解： 满足LP模型的约束条件且满足非负条件的解。

> **定理1: 若线性规划(LP)问题存在可行解，那么该问题的可行域是凸集。**

​		如果集合C中任意两个点X1、X2，其连线上的所有点也都是集合C中的点，称C为凸集。

​		如果对于任意$x,y\in D$有$\lambda x+(1-\lambda)y \in D \quad \forall 0 \leq \lambda \leq 1$，称集合$D\subset R^n$为凸集。

### 极点

​		设$S$是非空凸集,$x\in S$，若由$x=\lambda x^{(1)}+(1-\lambda)x^{(2)}$,其中$\lambda \in (0,1),x^{(1)},x^{(2)} \in S$,必推出$x=x^{(1)}=x^{(2)}$， 则称$x$是$S$的极点．

### 基和基本解

​		系数矩阵A中任意m列所组成的m阶可逆子方阵$B$，称为(LP)的一个基(矩阵)，变量$x_j$，若它所对应的列$P_j$包 含在基$B$中，则称$x_j$为**基变量**，否则称为非基变量。基变量的全体称为一组基变量。

​		基矩阵的个数最多为$C^m_n=\frac{n!}{m!(n-m)!}$

​		设$A=[B\quad N]$，其中$rank(B)=m$，设$x=\begin{bmatrix} x_B \\x_N \end{bmatrix}$，可得$x_B=B^{-1}b-B^{-1}Nx_N$。令$x_N=0$，$x= \begin{bmatrix} B^{-1}b \\ 0 \end{bmatrix} $，称为LP的基本解。

​		若$B^{-1}b \geq 0$，称$x=\begin{bmatrix}  B^{-1}b \\ 0 \end{bmatrix} $为LP的基本可行解。若$B^{-1}b \geq 0$，称基本可行解是非退化的。

​		基本可行解都在可行域的极点出现。

### 极方向

​		设$S$是$R^n$中的凸集，$d \in R$，$d \neq 0$如果对$\forall x \in S$，有$\{x|x+\lambda d|\lambda \geq 0 \subset S \}$，则称向量$d$为$S$的极方向。

​		若$S$的方向$d$不能表示为集合的两个不同方向的正的线性组合，则$d$为$S$的极方向。

​		极方向集合为空集的充要条件为多面集S有界。若S无界，则有有限个极方向。

### 最优极点

​		若问题存在最优解，一定存在一个基可行解是最优解。（或在某个顶点取得）

> 定理2：设线性规划(LP)的可行域非空，则：
>
> 1. (LP)存在有限最优解的充要条件是对任意的$j$, $c^Td^{j}\leq0$,  其中$d^{(j)}$为可行域的极方向。
> 2. 若(LP)存在有限最优解，则目标函数的最优值可在某个极点达到。

## 单纯形法

```flow
st=>start: 初始基可行解
op1=>operation: 迭代换基
op2=>operation: 新的基可行解
cond=>condition: 最优性条件
e=>end: 最优解

st->cond
cond(yes)->e
cond(no)->op1(right)->op2(top)->cond
```

1. 化为标准型
2. 寻找初始基可行解
3. 判断是否最优，能否找到另一个基可行解使目标函数值增加
4. 迭代换基
   1. 寻找一个非基变量作为换出变量，确定一个基作为换出变量。
   2. 换基原则：新的基可行解能使目标值增大，新的基仍然是可行基

### 单纯形法表的计算步骤

1. 将问题化为标准型
2. 求线性规划的初始基可行解，列出初始单纯形表
3. 进行最优性检验。
   1. 如果所有检验数$\sigma\leq0$，则表中的基可行解就是问题的最优解。否则继续下一步。
4. 从一个基可行解转换到另一个目标值更大的基可行解，列出新的单纯形表。
   1. 确定换入基的变量。选择$\sigma\geq0$，对应的变量 $x_j$作为换入变量，当有一个以上检验数大于0时，一般选择最大的一个检验数，即：$\sigma_k=max\{\sigma_j|\sigma_j>0\}$，其对应的$x_k$作为换入变量。
   2. 确定换出变量。根据$\theta_L=min\{\frac{b_i}{a_{ik}}|a_{ik}>0\}$计算并选择$\theta$ ，选最小的$\theta$对应基变量作为换出变量。
   3. 用换入变量$x_k$替换基变量中的换出变量，得到一个新的基对应新的基可以找出一个新的基可行解，并相应地可以画出一个新的单纯形表。
5. 重复3、4，直到计算结束。

​		若某个非基变量的检验数为0，LP存在多个最优解。

​		若存在检验数大于0且对应系数列向量$\leq0$（存在极方向），LP存在无界解。

### 人工变量法

​		人为形成单位基矩阵

#### 大M法

​		人为添加单位向量，建立初始单纯形表。M是充分大的数。

​		如果在求解过程中人工变量不能消去，则认为原问题没有最优解。

#### 两阶段法

